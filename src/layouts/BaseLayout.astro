---
import "../styles/tailwind.css";

const {
  title = "Dávid Juhász's Pages",
  description = "A personal portfolio site showcasing projects and sharing insights.",
  keywords = "portfolio, projects, professional, compiler, developer tooling, embedded systems, systems engineer",
  image = null, // Optional full URL for og:image
  localImage = "/og/default.png", // local path for og:image, used if image is null, relative to `public/`
  type = "website", // defines content type: e.g., website, article, profile (see og:type)
  canonical = null
} = Astro.props;

const imageUrl = image ?? new URL(localImage, Astro.site).toString()
const currentPath = Astro.url.pathname;
const canonicalUrl = canonical ?? new URL(currentPath, Astro.site).toString();
const isActive = (path) =>
  path === '/'
    ? currentPath === '/'
    : currentPath.startsWith(path);
---

<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />

    <!-- SEO tags -->
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="author" content="Dávid Juhász" />
    <meta name="keywords" content={keywords} />
    <link rel="canonical" href={canonicalUrl} />

    <!-- Open Graph -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={imageUrl} />
    <meta property="og:type" content={type} />
    <meta property="og:url" content={canonicalUrl} />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png" media="(prefers-color-scheme: light)" />
    <link rel="icon" type="image/png" href="/favicon-dark.png" media="(prefers-color-scheme: dark)" />

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Dávid Juhász",
      "url": "https://davidjuhasz.dev",
      "image": "https://davidjuhasz.dev/images/me.jpg",
      "sameAs": [
        "https://www.linkedin.com/in/juhaszdavid",
        "https://github.com/juhda"
      ],
      "jobTitle": "Compiler & Systems Engineer"
      <!--
        , "worksFor": {
          "@type": "Organization",
          "name": "Your Freelance Brand or Company"
        }
      -->
    }
    </script>

    {import.meta.env.MODE === 'production' && (
      <script data-goatcounter="https://stats.davidjuhasz.dev/count"
        async src="//gc.zgo.at/count.js"></script>
    )}

  </head>
  <body class="flex flex-col h-screen bg-bg text-primary font-sans">
    <header class="bg-surface p-4 shadow-md border-b border-muted">
      <nav class="flex justify-between items-center max-w-4xl mx-auto">
        <h1 class="text-xl font-bold text-primary">{title}</h1>
        <ul class="flex space-x-4">
          <li>
            <a href="/" class={`nav-link ${isActive('/') ? 'active' : ''}`}>Home</a>
          </li>
          <li>
            <a href="/portfolio" class={`nav-link ${isActive('/portfolio') ? 'active' : ''}`}>Portfolio</a>
          </li>
        </ul>
      </nav>
    </header>


    <!-- Main content takes remaining height -->
    <main
      class={`flex-1 overflow-hidden ${
        Astro.props.noPadding ? 'w-full h-full' : 'p-4 max-w-4xl mx-auto'
      }`}
    >
      <slot />
    </main>
  </body>
</html>
